<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Una decisi√≥n de 195 mil millones para cumplir ¬øun capricho?</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .slider {
            -webkit-appearance: none;
            appearance: none;
            height: 12px;
            border-radius: 6px;
            background: #e5e7eb;
            outline: none;
            transition: all 0.3s ease;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #7010A6;
            cursor: pointer;
            box-shadow: 0 3px 6px rgba(112, 16, 166, 0.3);
            transition: all 0.2s ease;
        }
        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 8px rgba(112, 16, 166, 0.4);
        }
        .slider::-moz-range-thumb {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: #7010A6;
            cursor: pointer;
            box-shadow: 0 3px 6px rgba(112, 16, 166, 0.3);
            border: none;
        }
        .slider:hover {
            opacity: 0.9;
        }
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #7010A6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>

    <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WG7JLVDS');</script>
  <!-- End Google Tag Manager -->
    
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WG7JLVDS"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->
  
    <div class="min-h-screen bg-gradient-to-br from-purple-50 to-yellow-50">
        <div class="max-w-7xl mx-auto px-4 py-8">
            
            <!-- ======== HEADER SECTION ======== -->
            <header class="text-center mb-12">
                <!-- Imagen del header -->
                <div class="max-w-4xl mx-auto mb-8">
                    <img src="HeaderMaryplaya.png" alt="Header Mar y Playa Medell√≠n" 
                         class="w-full rounded-xl shadow-lg">
                </div>
                
                <h1 class="text-2xl md:text-4xl font-bold mb-8" style="color: #7010A6;">
                    ¬ø195 mil millones en "mar" mientras Medell√≠n se ahoga en problemas reales?
                </h1>
                
                <!-- Contenedor principal con mismo ancho que la imagen -->
                <div class="max-w-4xl mx-auto space-y-6">
                    <!-- Estad√≠sticas de pobreza -->
                    <div class="bg-white rounded-xl p-6 shadow-lg" style="background: rgba(112, 16, 166, 0.02);">
                        <h3 class="text-xl font-bold mb-4" style="color: #7010A6;">Mientras el Alcalde sue√±a con playas artificiales, Medell√≠n enfrenta:</h3>
                        <div class="grid md:grid-cols-3 gap-4 text-sm">
                            <div class="text-center p-4 bg-white rounded-lg shadow-sm">
                                <div class="text-2xl font-bold" style="color: #7010A6;">313,257</div>
                                <div class="text-gray-600">personas en pobreza multidimensional</div>
                            </div>
                            <div class="text-center p-4 bg-white rounded-lg shadow-sm">
                                <div class="text-2xl font-bold" style="color: #7010A6;">221,000</div>
                                <div class="text-gray-600">personas con inseguridad alimentaria severa</div>
                            </div>
                            <div class="text-center p-4 bg-white rounded-lg shadow-sm">
                                <div class="text-2xl font-bold" style="color: #7010A6;">128,000</div>
                                <div class="text-gray-600">personas viviendo en hacinamiento</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mensaje central -->
                    <div class="bg-white rounded-xl p-6 shadow-lg" style="background: rgba(252, 215, 0, 0.05);">
                        <p class="text-lg font-semibold mb-2" style="color: #7010A6;">
                            ¬øEs el mar una prioridad en Medell√≠n cuando hay otras necesidades sin resolver?
                        </p>
                        <p class="text-gray-600">
                            Esta respuesta parece m√°s un capricho personal que una soluci√≥n a lo que Medell√≠n realmente necesita.
                        </p>
                    </div>
                    
                    <!-- Alternativas de inversi√≥n -->
                    <div class="bg-white rounded-xl p-6 shadow-lg" style="background: rgba(112, 16, 166, 0.02);">
                        <h3 class="text-xl font-bold mb-6" style="color: #7010A6;">Con esos 195 mil millones, en lugar de Mar y Playa, podr√≠amos:</h3>
                        
                        <div class="grid md:grid-cols-2 gap-4">
                            <div class="text-center p-6 bg-white rounded-lg shadow-sm" style="background: rgba(252, 215, 0, 0.08);">
                                <div class="text-4xl mb-3">üè†</div>
                                <div class="text-2xl font-bold text-gray-800 mb-2">650 casas</div>
                                <div class="text-sm text-gray-600 mb-2">de 300 millones cada una</div>
                                <div class="text-base font-semibold" style="color: #7010A6;">1 de cada 10 familias de Bel√©n</div>
                            </div>
                            
                            <div class="text-center p-6 bg-white rounded-lg shadow-sm" style="background: rgba(112, 16, 166, 0.08);">
                                <div class="text-4xl mb-3">üè´</div>
                                <div class="text-2xl font-bold text-gray-800 mb-2">5 mega colegios</div>
                                <div class="text-sm text-gray-600 mb-2">para atender m√°s de 8000 estudiantes</div>
                                <div class="text-base font-semibold" style="color: #7010A6;">y asegurar la cobertura con criterios de calidad</div>
                            </div>
                            
                            <div class="text-center p-6 bg-white rounded-lg shadow-sm" style="background: rgba(252, 215, 0, 0.08);">
                                <div class="text-4xl mb-3">üõ†Ô∏è</div>
                                <div class="text-2xl font-bold text-gray-800 mb-2">6,845 metros</div>
                                <div class="text-sm text-gray-600 mb-2">obras de estabilizaci√≥n</div>
                                <div class="text-base font-semibold" style="color: #7010A6;">para prevenir accidentes mortales</div>
                            </div>
                            
                            <div class="text-center p-6 bg-white rounded-lg shadow-sm" style="background: rgba(112, 16, 166, 0.08);">
                                <div class="text-4xl mb-3">üéì</div>
                                <div class="text-2xl font-bold text-gray-800 mb-2">32,500 semestres</div>
                                <div class="text-sm text-gray-600 mb-2">universitarios</div>
                                <div class="text-base font-semibold" style="color: #7010A6;">todos los j√≥venes de Popular y Santa Cruz</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Call to action -->
                    <div class="rounded-xl p-6 text-white shadow-lg" style="background: linear-gradient(135deg, #7010A6 0%, #8B2CA3 100%);">
                        <p class="text-lg font-semibold text-center mb-2">
                            El "mar" es el capricho de uno. Las necesidades son de todos.
                        </p>
                        <p class="text-xl font-bold text-center" style="color: #FCD700;">
                            Si t√∫ fueras alcalde que priorizar√≠as para Medell√≠n, ¬øcaprichos o necesidades?
                        </p>
                    </div>
                </div>
            </header>

            <!-- ======== DISTRIBUCI√ìN SECTION ======== -->
            <div class="max-w-4xl mx-auto mb-12">
                <div class="bg-white rounded-xl shadow-lg" style="background: rgba(112, 16, 166, 0.02);">
                    <div class="text-center p-6 rounded-xl" style="background: linear-gradient(135deg, #7010A6 0%, #8B2CA3 100%); border-radius: 0.75rem 0.75rem 0 0;">
                        <h2 class="text-2xl font-bold text-white mb-2">Es hora de que Medell√≠n realmente decida</h2>
                        <p class="text-gray-100">Mueve las barras para mostrar cu√°les son las prioridades de Medell√≠n</p>
                        <p class="text-sm font-semibold mt-2" style="color: #FCD700;">üí° Tip: Las barras se mueven en incrementos de $1,000 millones</p>
                    </div>
                    
                    <div class="p-6">
                        <div class="grid lg:grid-cols-3 gap-8">
                            <!-- Sliders (2 columnas en desktop) -->
                            <div class="lg:col-span-2">
                                <div class="grid md:grid-cols-2 gap-4" id="sliders-container">
                                    <!-- Se llenar√°n con JavaScript -->
                                </div>
                            </div>
                            
                            <!-- Contador lateral -->
                            <div class="lg:col-span-1">
                                <div class="sticky top-4 bg-white rounded-xl p-6 text-center shadow-md" style="background: rgba(252, 215, 0, 0.05);">
                                    <h3 class="text-lg font-bold mb-4" style="color: #7010A6;">Presupuesto por distribuir</h3>
                                    <div id="contador" class="text-4xl font-bold mb-2" style="color: #7010A6;">
                                        $195,000
                                    </div>
                                    <div class="text-lg text-gray-700 mb-4">
                                        millones de pesos
                                    </div>
                                    <div id="estado-texto" class="text-sm text-gray-600 mb-4">
                                        Distribuye el presupuesto completo
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-4 mb-4">
                                        <div id="barra-progreso" class="h-4 rounded-full transition-all duration-300" 
                                             style="width: 0%; background: linear-gradient(to right, #7010A6, #FCD700);"></div>
                                    </div>
                                    <div id="mensaje-completado" class="hidden">
                                        <div class="text-green-600 font-bold text-lg mb-3">
                                            ‚úì ¬°Presupuesto redistribuido!
                                        </div>
                                        <button onclick="scrollToGrafico()" class="text-white font-bold py-3 px-6 rounded-lg transition-all shadow-md hover:shadow-lg" 
                                                style="background: linear-gradient(135deg, #7010A6 0%, #8B2CA3 100%);">
                                            Ver mi propuesta ciudadana ‚Üì
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ======== PROPUESTA CIUDADANA SECTION (oculto inicialmente) ======== -->
            <div id="grafico-container" class="max-w-4xl mx-auto mb-12 hidden">
                <div class="bg-white rounded-xl shadow-lg" style="background: rgba(252, 215, 0, 0.02);">
                    <div class="p-6 rounded-xl" style="background: rgba(252, 215, 0, 0.9); border-radius: 0.75rem 0.75rem 0 0;">
                        <h3 class="text-2xl font-bold text-center mb-2" style="color: #7010A6;">Si yo fuera Alcalde, NO gastar√≠a en caprichos</h3>
                        <h3 class="text-2xl font-bold text-center mb-2" style="color: #7010A6;">Invertir√≠a 195 mil millones en:</h3>
                        <p class="text-gray-700 text-center">Mi propuesta responde a las necesidades que vivo</p>
                    </div>
                    <div class="p-6">
                        <div id="barras-container" class="space-y-4 mb-8">
                            <!-- Se llenar√°n con JavaScript -->
                        </div>
                        
                        <div class="text-center">
                            <button onclick="generarImagen()" class="text-white font-bold py-3 px-8 rounded-lg transition-all shadow-md hover:shadow-lg" 
                                    style="background: linear-gradient(135deg, #7010A6 0%, #8B2CA3 100%);">
                                üì∏ Generar imagen para compartir
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Canvas oculto -->
            <canvas id="canvas" style="display: none;"></canvas>

            <!-- ======== COMPARTIR SECTION (oculto inicialmente) ======== -->
            <div id="compartir-container" class="max-w-4xl mx-auto mb-12 hidden">
                <div class="bg-white rounded-xl shadow-lg" style="background: rgba(112, 16, 166, 0.02);">
                    <div class="p-6 rounded-xl" style="background: linear-gradient(135deg, #7010A6 0%, #8B2CA3 100%); border-radius: 0.75rem 0.75rem 0 0;">
                        <h3 class="text-2xl font-bold text-white text-center">Comparte tu propuesta</h3>
                    </div>
                    <div class="p-6">
                        <div class="mb-6">
                            <img id="imagen-preview" alt="Mi propuesta" class="w-full rounded-lg shadow-lg" />
                        </div>
                        <div class="flex flex-wrap gap-4 justify-center">
                            <button onclick="descargarImagen()" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-md hover:shadow-lg">
                                ‚¨áÔ∏è Descargar
                            </button>
                            <button onclick="compartirEnRedes('twitter')" class="bg-blue-400 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-md hover:shadow-lg">
                                üê¶ X 
                            </button>
                            <button onclick="compartirEnRedes('facebook')" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-md hover:shadow-lg">
                                üìò Facebook
                            </button>
                            <button onclick="compartirEnRedes('whatsapp')" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-all shadow-md hover:shadow-lg">
                                üí¨ WhatsApp
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ======== FORMULARIO SECTION (oculto inicialmente) ======== -->
            <div id="formulario-container" class="max-w-4xl mx-auto mb-12 hidden">
                <div class="bg-white rounded-xl shadow-lg" style="background: rgba(252, 215, 0, 0.02);">
                    <div class="p-6 rounded-xl" style="background: rgba(252, 215, 0, 0.9); border-radius: 0.75rem 0.75rem 0 0;">
                        <h3 class="text-2xl font-bold text-center mb-2" style="color: #7010A6;">Tu voz importa</h3>
                        <p class="text-gray-700 text-center">√önete a la Medell√≠n que tiene clara sus prioridades</p>
                    </div>
                    
                    <form id="formulario-contacto" class="p-6">
                        <!-- Datos personales opcionales -->
                        <div class="rounded-xl p-6 mb-6 bg-white shadow-sm" style="background: rgba(112, 16, 166, 0.05);">
                            <h4 class="font-bold mb-4" style="color: #7010A6;">Datos de contacto (opcional)</h4>
                            <p class="text-sm text-gray-600 mb-4">Si deseas recibir actualizaciones sobre esta iniciativa de control pol√≠tico</p>
                            
                            <div class="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label for="nombre" class="block text-sm font-medium text-gray-700 mb-1">Nombre</label>
                                    <input type="text" id="nombre" name="nombre" 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:border-transparent"
                                           style="focus:ring-color: #7010A6;"
                                           placeholder="Tu nombre (opcional)">
                                </div>
                                
                                <div>
                                    <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Correo electr√≥nico</label>
                                    <input type="email" id="email" name="email" 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:border-transparent"
                                           style="focus:ring-color: #7010A6;"
                                           placeholder="tu@email.com (opcional)">
                                </div>
                                
                                <div>
                                    <label for="whatsapp" class="block text-sm font-medium text-gray-700 mb-1">WhatsApp</label>
                                    <input type="tel" id="whatsapp" name="whatsapp" 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:border-transparent"
                                           style="focus:ring-color: #7010A6;"
                                           placeholder="300 123 4567 (opcional)">
                                </div>
                                
                                <div class="flex items-center">
                                    <input type="checkbox" id="autorizo" name="autorizo" class="mr-2" style="accent-color: #7010A6;">
                                    <label for="autorizo" class="text-sm text-gray-700">
                                        Autorizo el uso de mis datos para esta iniciativa
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Campo de ideas -->
                        <div class="rounded-xl p-6 mb-6 bg-white shadow-sm" style="background: rgba(252, 215, 0, 0.08);">
                            <h4 class="font-bold mb-4" style="color: #7010A6;">Comparte tus ideas</h4>
                            <p class="text-sm text-gray-600 mb-4">¬øQu√© otras propuestas tienes para mejorar Medell√≠n? (m√°ximo 200 palabras)</p>
                            
                            <textarea id="ideas" name="ideas" rows="5" maxlength="1000"
                                      class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:border-transparent"
                                      style="focus:ring-color: #FCD700;"
                                      placeholder="Cu√©ntanos tus ideas para un mejor uso de los recursos p√∫blicos..."></textarea>
                            <div class="text-right text-sm text-gray-500 mt-1">
                                <span id="contador-caracteres">0</span>/1000 caracteres
                            </div>
                        </div>
                        
                        <!-- Bot√≥n de env√≠o -->
                        <div class="text-center">
                            <button type="submit" id="btn-enviar" 
                                    class="text-white font-bold py-3 px-8 rounded-lg transition-all shadow-md hover:shadow-lg"
                                    style="background: linear-gradient(135deg, #7010A6 0%, #8B2CA3 100%);">
                                Enviar mi propuesta ciudadana
                            </button>
                            <div id="mensaje-enviando" class="hidden mt-4">
                                <div class="loading-spinner mx-auto"></div>
                                <p class="text-sm text-gray-600 mt-2">Enviando...</p>
                            </div>
                            <div id="mensaje-exito" class="hidden mt-4 p-4 bg-green-50 border border-green-400 text-green-700 rounded-lg">
                                ‚úì ¬°Gracias por participar! Tu voz ha sido registrada.
                            </div>
                            <div id="mensaje-error" class="hidden mt-4 p-4 bg-red-50 border border-red-400 text-red-700 rounded-lg">
                                ‚úó Hubo un error. Por favor intenta de nuevo.
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- ======== FOOTER ======== -->
            <footer class="text-center py-8 text-gray-600 max-w-4xl mx-auto">
                <div class="border-t pt-6" style="border-color: rgba(112, 16, 166, 0.2);">
                    <p class="mb-2 font-semibold" style="color: #7010A6;">Medell√≠n reflexiona sobre sus necesidades</p>
                    <p class="text-sm">¬øQu√© es lo √∫nico que le hace falta a Medell√≠n?<br>
                    Por m√°s derechos y menos caprichos; control pol√≠tico ciudadano.</p>
                </div>
            </footer>
        </div>
    </div>

    <script>
        // Configuraci√≥n
        const PRESUPUESTO_TOTAL = 195000; // En millones
        // Usar proxy de Netlify (IMPORTANTE: no usar la URL directa de Google)
        const BACKEND_URL = '/.netlify/functions/googleProxy';
        
        let imageUrl = '';
        let compartidoEnRedes = false;
        let redCompartida = '';
        let formularioCompletado = false;
        const tiempoInicio = Date.now();
        
        const categorias = [
            { id: 'salud', nombre: 'Salud', emoji: 'üè•', color: '#7010A6' },
            { id: 'educacion', nombre: 'Educaci√≥n', emoji: 'üìö', color: '#FCD700' },
            { id: 'seguridad', nombre: 'Seguridad', emoji: 'üëÆ', color: '#8B2CA3' },
            { id: 'vivienda', nombre: 'Vivienda', emoji: 'üè†', color: '#E6C200' },
            { id: 'movilidad', nombre: 'Movilidad', emoji: 'üöå', color: '#7010A6' },
            { id: 'servicios', nombre: 'Servicios P√∫blicos', emoji: 'üö∞', color: '#FCD700' },
            { id: 'deporte', nombre: 'Deporte y Recreaci√≥n', emoji: '‚öΩ', color: '#8B2CA3' },
            { id: 'cultura', nombre: 'Cultura', emoji: 'üé≠', color: '#E6C200' }
        ];

        // Estado de distribuci√≥n
        let distribucion = {};
        categorias.forEach(cat => {
            distribucion[cat.id] = 0;
        });

        // Formatear n√∫meros
        function formatearMiles(valor) {
            return new Intl.NumberFormat('es-CO').format(valor);
        }

        // Scroll suave al gr√°fico
        function scrollToGrafico() {
            document.getElementById('grafico-container').scrollIntoView({ behavior: 'smooth' });
        }

        // Actualizar contador
        function actualizarContador() {
            const totalAsignado = Object.values(distribucion).reduce((sum, val) => sum + val, 0);
            const restante = PRESUPUESTO_TOTAL - totalAsignado;
            const porcentajeAsignado = (totalAsignado / PRESUPUESTO_TOTAL) * 100;
            
            const contador = document.getElementById('contador');
            const estadoTexto = document.getElementById('estado-texto');
            const barraProgreso = document.getElementById('barra-progreso');
            const mensajeCompletado = document.getElementById('mensaje-completado');
            const graficoContainer = document.getElementById('grafico-container');
            const compartirContainer = document.getElementById('compartir-container');
            const formularioContainer = document.getElementById('formulario-container');
            
            contador.textContent = `$${formatearMiles(Math.abs(restante))}`;
            barraProgreso.style.width = `${porcentajeAsignado}%`;
            
            if (restante === 0) {
                contador.className = 'text-4xl font-bold text-green-600 mb-2';
                estadoTexto.textContent = '¬°Distribuci√≥n completa!';
                estadoTexto.className = 'text-sm text-green-600 mb-4 font-bold';
                mensajeCompletado.classList.remove('hidden');
                graficoContainer.classList.remove('hidden');
                formularioContainer.classList.remove('hidden');
                // Ocultar compartir hasta que generen la imagen
                compartirContainer.classList.add('hidden');
                actualizarGrafico();
                // Enviar datos autom√°ticamente cuando completan la distribuci√≥n
                enviarDatosAGoogleSheets();
            } else if (restante > 0) {
                contador.className = 'text-4xl font-bold mb-2';
                contador.style.color = '#7010A6';
                estadoTexto.textContent = `Faltan ${formatearMiles(restante)} millones por asignar`;
                estadoTexto.className = 'text-sm text-gray-600 mb-4';
                mensajeCompletado.classList.add('hidden');
                graficoContainer.classList.add('hidden');
                compartirContainer.classList.add('hidden');
                formularioContainer.classList.add('hidden');
            } else {
                contador.className = 'text-4xl font-bold text-red-600 mb-2';
                estadoTexto.textContent = `Te excediste por ${formatearMiles(Math.abs(restante))} millones`;
                estadoTexto.className = 'text-sm text-red-600 mb-4';
                mensajeCompletado.classList.add('hidden');
                graficoContainer.classList.add('hidden');
                compartirContainer.classList.add('hidden');
                formularioContainer.classList.add('hidden');
            }
        }

        // Manejar cambio de slider
        function handleSliderChange(categoria, valor) {
            const nuevoValor = parseInt(valor);
            const otrosValores = Object.entries(distribucion)
                .filter(([cat]) => cat !== categoria)
                .reduce((sum, [, val]) => sum + val, 0);
            
            if (otrosValores + nuevoValor <= PRESUPUESTO_TOTAL) {
                distribucion[categoria] = nuevoValor;
                
                // Actualizar valor mostrado
                document.getElementById(`valor-${categoria}`).textContent = `$${formatearMiles(nuevoValor)}M`;
                document.getElementById(`porcentaje-${categoria}`).textContent = 
                    `${((nuevoValor / PRESUPUESTO_TOTAL) * 100).toFixed(1)}%`;
                
                // Actualizar color del slider
                const slider = document.getElementById(`slider-${categoria}`);
                const porcentaje = (nuevoValor / PRESUPUESTO_TOTAL) * 100;
                const cat = categorias.find(c => c.id === categoria);
                slider.style.background = `linear-gradient(to right, ${cat.color} 0%, ${cat.color} ${porcentaje}%, #e5e7eb ${porcentaje}%, #e5e7eb 100%)`;
                
                actualizarContador();
            } else {
                // Revertir el slider si excede el presupuesto
                document.getElementById(`slider-${categoria}`).value = distribucion[categoria];
            }
        }

        //
