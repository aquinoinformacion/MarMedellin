<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>¬ø195 mil millones en piscinas y a Medell√≠n no le faltar√° nada m√°s?</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .slider {
            -webkit-appearance: none;
            appearance: none;
            height: 10px;
            border-radius: 5px;
            background: #e5e7eb;
            outline: none;
            transition: all 0.3s ease;
        }
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #7010A6;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #7010A6;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .slider:hover {
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <div id="root">
        <div class="min-h-screen bg-gradient-to-br from-purple-50 to-yellow-50">
            <div class="max-w-7xl mx-auto px-4 py-8">
                <!-- Header -->
                <header class="text-center mb-10">
                    <h1 class="text-3xl md:text-5xl font-bold text-purple-900 mb-6">
                        ¬ø195 mil millones en piscinas y a Medell√≠n no le faltar√° nada m√°s?
                    </h1>
                    
                    <!-- Contexto -->
                    <div class="bg-white rounded-lg shadow-lg p-6 mb-8 max-w-4xl mx-auto">
                        <div class="bg-purple-100 border-l-4 border-purple-600 p-4 mb-6">
                            <p class="text-lg italic text-purple-900">
                                Dijo el Alcalde: <strong>"Lo √∫nico que le faltaba a Medell√≠n era mar y playa. Ahora no nos faltar√° nada"</strong> 
                                para justificar la inversi√≥n de 195 mil millones de pesos en la adecuaci√≥n de las piscinas del Juan Pablo II.
                            </p>
                        </div>
                        
                        <p class="text-lg text-gray-700 mb-6">
                            El deporte es fundamental y creemos en √©l. <strong>¬øPero en serio con esa inversi√≥n a Medell√≠n no le faltar√° nada?</strong>
                        </p>
                        
                        <h3 class="text-2xl font-bold text-purple-900 mb-4">¬øQu√© puedes hacer con 195 mil millones de pesos?</h3>
                        
                        <div class="grid md:grid-cols-2 gap-4 text-left">
                            <div class="bg-yellow-50 p-4 rounded-lg border-l-4 border-yellow-500">
                                <span class="text-2xl mb-2">üè†</span>
                                <p class="text-sm">Con 195 mil millones podr√≠as comprar <strong>650 casas</strong> de 300 millones cada una. 
                                Eso significa darle casa propia a <strong>1 de cada 10 familias de Bel√©n</strong> (la comuna m√°s poblada con 222,266 habitantes)</p>
                            </div>
                            
                            <div class="bg-green-50 p-4 rounded-lg border-l-4 border-green-500">
                                <span class="text-2xl mb-2">üõí</span>
                                <p class="text-sm">Con 325,000 mercados de $600,000, podr√≠as alimentar durante <strong>un mes completo a TODAS las familias 
                                de Laureles-Estadio, La Am√©rica y Guayabal juntas</strong> (254,521 habitantes)</p>
                            </div>
                            
                            <div class="bg-blue-50 p-4 rounded-lg border-l-4 border-blue-500">
                                <span class="text-2xl mb-2">üíµ</span>
                                <p class="text-sm">150,000 salarios m√≠nimos alcanzar√≠an para pagarle un mes a <strong>TODOS los habitantes 
                                de La Candelaria y Guayabal combinadas</strong> (144,764 personas)</p>
                            </div>
                            
                            <div class="bg-purple-50 p-4 rounded-lg border-l-4 border-purple-500">
                                <span class="text-2xl mb-2">üéì</span>
                                <p class="text-sm">32,500 semestres universitarios para becar la carrera completa a <strong>todos los j√≥venes 
                                de Popular y Santa Cruz</strong> (aprox. 5,400 j√≥venes de 18-25 a√±os)</p>
                            </div>
                        </div>
                        
                        <div class="mt-6 p-4 bg-purple-900 text-white rounded-lg">
                            <p class="text-lg font-semibold text-center">
                                Porque sentimos que en Medell√≠n faltan muchas cosas, si t√∫ fueras la alcaldesa o el alcalde de esta ciudad 
                                <span class="text-yellow-300">¬øC√≥mo repartir√≠as ese presupuesto?</span>
                            </p>
                        </div>
                    </div>
                </header>

                <!-- Distribuidor de presupuesto -->
                <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
                    <div class="text-center mb-6">
                        <h2 class="text-2xl font-bold text-purple-900 mb-2">¬°Tu opini√≥n cuenta!</h2>
                        <p class="text-gray-600">Mueve las barras para asignar los 195 mil millones en lo que consideras que realmente necesita Medell√≠n</p>
                    </div>
                    
                    <div class="grid lg:grid-cols-3 gap-6">
                        <!-- Sliders (2 columnas en desktop) -->
                        <div class="lg:col-span-2">
                            <div class="grid md:grid-cols-2 gap-4" id="sliders-container">
                                <!-- Se llenar√°n con JavaScript -->
                            </div>
                        </div>
                        
                        <!-- Contador lateral -->
                        <div class="lg:col-span-1">
                            <div class="sticky top-4 bg-gradient-to-br from-purple-100 to-yellow-100 rounded-lg p-6 text-center">
                                <h3 class="text-lg font-bold text-purple-900 mb-4">Presupuesto por asignar</h3>
                                <div id="contador" class="text-4xl font-bold text-yellow-600 mb-2">
                                    $195,000
                                </div>
                                <div class="text-lg text-gray-700 mb-4">
                                    millones de pesos
                                </div>
                                <div id="estado-texto" class="text-sm text-gray-600 mb-4">
                                    Distribuye el presupuesto completo
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-4 mb-4">
                                    <div id="barra-progreso" class="bg-gradient-to-r from-purple-600 to-yellow-500 h-4 rounded-full transition-all duration-300" 
                                         style="width: 0%"></div>
                                </div>
                                <div id="mensaje-completado" class="hidden">
                                    <div class="text-green-600 font-bold text-lg mb-3">
                                        ‚úì ¬°Presupuesto completo!
                                    </div>
                                    <button onclick="scrollToGrafico()" class="bg-purple-700 hover:bg-purple-800 text-white font-bold py-2 px-4 rounded-lg">
                                        Ver mi distribuci√≥n ‚Üì
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gr√°fico (oculto inicialmente) -->
                <div id="grafico-container" class="bg-white rounded-lg shadow-lg p-6 mb-8 hidden">
                    <h3 class="text-2xl font-bold text-purple-900 mb-2 text-center">Si yo fuera Alcalde invertir√≠a 195 mil millones en:</h3>
                    <p class="text-gray-600 text-center mb-6">Esta es tu propuesta de distribuci√≥n presupuestal</p>
                    <div id="barras-container" class="space-y-3 max-w-4xl mx-auto">
                        <!-- Se llenar√°n con JavaScript -->
                    </div>
                    
                    <div class="mt-8 flex justify-center">
                        <button onclick="generarImagen()" class="bg-purple-700 hover:bg-purple-800 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                            üì∏ Generar imagen para compartir
                        </button>
                    </div>
                </div>

                <!-- Canvas oculto -->
                <canvas id="canvas" style="display: none;"></canvas>

                <!-- Preview y compartir (oculto inicialmente) -->
                <div id="compartir-container" class="bg-white rounded-lg shadow-lg p-6 mb-8 hidden">
                    <h3 class="text-2xl font-bold text-purple-900 mb-4 text-center">Comparte tu propuesta</h3>
                    <div class="mb-6">
                        <img id="imagen-preview" alt="Mi propuesta" class="w-full max-w-2xl mx-auto rounded-lg shadow-lg" />
                    </div>
                    <div class="flex flex-wrap gap-4 justify-center">
                        <button onclick="descargarImagen()" class="bg-gray-700 hover:bg-gray-800 text-white font-bold py-3 px-6 rounded-lg">
                            ‚¨áÔ∏è Descargar
                        </button>
                        <button onclick="compartirEnRedes('twitter')" class="bg-blue-400 hover:bg-blue-500 text-white font-bold py-3 px-6 rounded-lg">
                            üê¶ Twitter
                        </button>
                        <button onclick="compartirEnRedes('facebook')" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg">
                            üìò Facebook
                        </button>
                        <button onclick="compartirEnRedes('whatsapp')" class="bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg">
                            üí¨ WhatsApp
                        </button>
                    </div>
                </div>

                <!-- Footer -->
                <footer class="text-center py-8 text-gray-600">
                    <p class="mb-2">Una iniciativa ciudadana para el presupuesto participativo de Medell√≠n</p>
                    <p class="text-sm font-bold">#Medell√≠nDecide #PresupuestoParticipativo</p>
                </footer>
            </div>
        </div>
    </div>

    <script>
        // Configuraci√≥n
        const PRESUPUESTO_TOTAL = 195000; // En millones
        let imageUrl = '';
        
        const categorias = [
            { id: 'salud', nombre: 'Salud', emoji: 'üè•', color: '#FF6B6B' },
            { id: 'educacion', nombre: 'Educaci√≥n', emoji: 'üìö', color: '#4ECDC4' },
            { id: 'seguridad', nombre: 'Seguridad', emoji: 'üëÆ', color: '#45B7D1' },
            { id: 'vivienda', nombre: 'Vivienda', emoji: 'üè†', color: '#96CEB4' },
            { id: 'movilidad', nombre: 'Movilidad', emoji: 'üöå', color: '#FFEAA7' },
            { id: 'servicios', nombre: 'Servicios P√∫blicos', emoji: 'üö∞', color: '#DDA0DD' },
            { id: 'deporte', nombre: 'Deporte y Recreaci√≥n', emoji: '‚öΩ', color: '#98D8C8' },
            { id: 'cultura', nombre: 'Cultura', emoji: 'üé≠', color: '#F7DC6F' }
        ];

        // Estado de distribuci√≥n
        let distribucion = {};
        categorias.forEach(cat => {
            distribucion[cat.id] = 0;
        });

        // Formatear n√∫meros
        function formatearMiles(valor) {
            return new Intl.NumberFormat('es-CO').format(valor);
        }

        // Scroll suave al gr√°fico
        function scrollToGrafico() {
            document.getElementById('grafico-container').scrollIntoView({ behavior: 'smooth' });
        }

        // Actualizar contador
        function actualizarContador() {
            const totalAsignado = Object.values(distribucion).reduce((sum, val) => sum + val, 0);
            const restante = PRESUPUESTO_TOTAL - totalAsignado;
            const porcentajeAsignado = (totalAsignado / PRESUPUESTO_TOTAL) * 100;
            
            const contador = document.getElementById('contador');
            const estadoTexto = document.getElementById('estado-texto');
            const barraProgreso = document.getElementById('barra-progreso');
            const mensajeCompletado = document.getElementById('mensaje-completado');
            const graficoContainer = document.getElementById('grafico-container');
            
            contador.textContent = `$${formatearMiles(Math.abs(restante))}`;
            barraProgreso.style.width = `${porcentajeAsignado}%`;
            
            if (restante === 0) {
                contador.className = 'text-4xl font-bold text-green-600 mb-2';
                estadoTexto.textContent = '¬°Distribuci√≥n completa!';
                estadoTexto.className = 'text-sm text-green-600 mb-4 font-bold';
                mensajeCompletado.classList.remove('hidden');
                graficoContainer.classList.remove('hidden');
                actualizarGrafico();
            } else if (restante > 0) {
                contador.className = 'text-4xl font-bold text-yellow-600 mb-2';
                estadoTexto.textContent = `Faltan ${formatearMiles(restante)} millones por asignar`;
                estadoTexto.className = 'text-sm text-gray-600 mb-4';
                mensajeCompletado.classList.add('hidden');
                graficoContainer.classList.add('hidden');
            } else {
                contador.className = 'text-4xl font-bold text-red-600 mb-2';
                estadoTexto.textContent = `Te excediste por ${formatearMiles(Math.abs(restante))} millones`;
                estadoTexto.className = 'text-sm text-red-600 mb-4';
                mensajeCompletado.classList.add('hidden');
                graficoContainer.classList.add('hidden');
            }
        }

        // Manejar cambio de slider
        function handleSliderChange(categoria, valor) {
            const nuevoValor = parseInt(valor);
            const otrosValores = Object.entries(distribucion)
                .filter(([cat]) => cat !== categoria)
                .reduce((sum, [, val]) => sum + val, 0);
            
            if (otrosValores + nuevoValor <= PRESUPUESTO_TOTAL) {
                distribucion[categoria] = nuevoValor;
                
                // Actualizar valor mostrado
                document.getElementById(`valor-${categoria}`).textContent = `$${formatearMiles(nuevoValor)}M`;
                document.getElementById(`porcentaje-${categoria}`).textContent = 
                    `${((nuevoValor / PRESUPUESTO_TOTAL) * 100).toFixed(1)}%`;
                
                // Actualizar color del slider
                const slider = document.getElementById(`slider-${categoria}`);
                const porcentaje = (nuevoValor / PRESUPUESTO_TOTAL) * 100;
                const cat = categorias.find(c => c.id === categoria);
                slider.style.background = `linear-gradient(to right, ${cat.color} 0%, ${cat.color} ${porcentaje}%, #e5e7eb ${porcentaje}%, #e5e7eb 100%)`;
                
                actualizarContador();
            } else {
                // Revertir el slider si excede el presupuesto
                document.getElementById(`slider-${categoria}`).value = distribucion[categoria];
            }
        }

        // Actualizar gr√°fico de barras
        function actualizarGrafico() {
            const container = document.getElementById('barras-container');
            container.innerHTML = '';
            
            // Ordenar categor√≠as por valor de mayor a menor
            const categoriasOrdenadas = [...categorias].sort((a, b) => 
                distribucion[b.id] - distribucion[a.id]
            ).filter(cat => distribucion[cat.id] > 0);
            
            categoriasOrdenadas.forEach(cat => {
                const valor = distribucion[cat.id];
                const porcentaje = (valor / PRESUPUESTO_TOTAL) * 100;
                
                const barra = document.createElement('div');
                barra.className = 'flex items-center gap-3';
                barra.innerHTML = `
                    <div class="w-36 text-right flex items-center justify-end gap-2">
                        <span class="text-2xl">${cat.emoji}</span>
                        <span class="text-sm font-semibold">${cat.nombre}</span>
                    </div>
                    <div class="flex-1">
                        <div class="bg-gray-200 rounded-full h-10 relative overflow-hidden">
                            <div class="h-10 rounded-full flex items-center justify-end pr-3 transition-all duration-500" 
                                 style="width: ${porcentaje}%; background-color: ${cat.color}">
                                <span class="text-sm font-bold text-white">${porcentaje.toFixed(1)}%</span>
                            </div>
                        </div>
                    </div>
                    <div class="w-28 text-right font-bold text-purple-900">
                        $${formatearMiles(valor)}M
                    </div>
                `;
                container.appendChild(barra);
            });
        }

        // Generar imagen
        function generarImagen() {
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = 1200;
            canvas.height = 630;
            
            // Fondo con gradiente
            const gradient = ctx.createLinearGradient(0, 0, 1200, 630);
            gradient.addColorStop(0, '#7010A6');
            gradient.addColorStop(1, '#4A0E6B');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 1200, 630);
            
            // T√≠tulo
            ctx.fillStyle = '#FCD700';
            ctx.font = 'bold 42px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Si yo fuera Alcalde invertir√≠a', 600, 70);
            ctx.fillText('195 mil millones en:', 600, 115);
            
            // Dibujar barras
            const startY = 160;
            const barHeight = 35;
            const maxBarWidth = 700;
            const startX = 250;
            
            // Ordenar y filtrar categor√≠as
            const categoriasOrdenadas = [...categorias]
                .sort((a, b) => distribucion[b.id] - distribucion[a.id])
                .filter(cat => distribucion[cat.id] > 0);
            
            categoriasOrdenadas.forEach((cat, index) => {
                const y = startY + (index * (barHeight + 10));
                const valor = distribucion[cat.id];
                const porcentaje = (valor / PRESUPUESTO_TOTAL) * 100;
                const barWidth = (porcentaje / 100) * maxBarWidth;
                
                ctx.font = '24px Arial';
                ctx.fillStyle = '#FFFFFF';
                ctx.textAlign = 'right';
                ctx.fillText(`${cat.emoji} ${cat.nombre}`, startX - 10, y + 25);
                
                ctx.fillStyle = cat.color;
                ctx.fillRect(startX, y, barWidth, barHeight);
                
                ctx.fillStyle = '#FFFFFF';
                ctx.font = 'bold 20px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`${porcentaje.toFixed(1)}% - $${formatearMiles(valor)}M`, startX + barWidth + 10, y + 25);
            });
            
            // Footer
            ctx.fillStyle = '#FCD700';
            ctx.font = 'bold 24px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('¬øY a Medell√≠n no le faltar√° nada m√°s?', 600, 560);
            ctx.font = 'bold 20px Arial';
            ctx.fillText('#Medell√≠nDecide #PresupuestoParticipativo', 600, 590);
            
            imageUrl = canvas.toDataURL('image/png');
            document.getElementById('imagen-preview').src = imageUrl;
            document.getElementById('compartir-container').classList.remove('hidden');
            document.getElementById('compartir-container').scrollIntoView({ behavior: 'smooth' });
        }

        // Descargar imagen
        function descargarImagen() {
            const link = document.createElement('a');
            link.download = 'mi-presupuesto-medellin.png';
            link.href = imageUrl;
            link.click();
        }

        // Compartir en redes
        function compartirEnRedes(red) {
            const mensaje = encodeURIComponent('Si yo fuera Alcalde de Medell√≠n, invertir√≠a los 195 mil millones de manera diferente. ¬øY t√∫ c√≥mo los repartir√≠as? #Medell√≠nDecide');
            const url = encodeURIComponent(window.location.href);
            
            const urls = {
                twitter: `https://twitter.com/intent/tweet?text=${mensaje}&url=${url}`,
                facebook: `https://www.facebook.com/sharer/sharer.php?u=${url}`,
                whatsapp: `https://wa.me/?text=${mensaje}%20${url}`
            };
            
            window.open(urls[red], '_blank');
        }

        // Inicializar sliders
        function inicializarSliders() {
            const container = document.getElementById('sliders-container');
            
            categorias.forEach(cat => {
                const sliderDiv = document.createElement('div');
                sliderDiv.className = 'bg-gray-50 p-4 rounded-lg';
                sliderDiv.innerHTML = `
                    <div class="mb-3">
                        <div class="flex items-center justify-between mb-2">
                            <label class="flex items-center gap-2 font-semibold text-gray-700">
                                <span class="text-2xl">${cat.emoji}</span>
                                <span class="text-sm">${cat.nombre}</span>
                            </label>
                        </div>
                        <div class="flex items-center justify-between text-sm mb-2">
                            <span id="porcentaje-${cat.id}" class="text-gray-600">0%</span>
                            <span id="valor-${cat.id}" class="font-bold text-purple-900">$0M</span>
                        </div>
                        <input
                            type="range"
                            id="slider-${cat.id}"
                            min="0"
                            max="${PRESUPUESTO_TOTAL}"
                            step="100"
                            value="0"
                            onchange="handleSliderChange('${cat.id}', this.value)"
                            oninput="handleSliderChange('${cat.id}', this.value)"
                            class="slider w-full"
                            style="background: linear-gradient(to right, ${cat.color} 0%, ${cat.color} 0%, #e5e7eb 0%, #e5e7eb 100%)"
                        />
                    </div>
                `;
                container.appendChild(sliderDiv);
            });
        }

        // Inicializar al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', function() {
            inicializarSliders();
            actualizarContador();
        });
    </script>
</body>
</html>
